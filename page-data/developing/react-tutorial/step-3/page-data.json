{"componentChunkName":"component---src-pages-developing-react-tutorial-step-3-mdx","path":"/developing/react-tutorial/step-3/","result":{"pageContext":{"frontmatter":{"title":"3. Using APIs","description":"Welcome to Carbon! This tutorial will guide you in creating a React app using Next.js with the Carbon Design System.","tabs":["Overview","Step 1","Step 2","Step 3","Step 4","Step 5","Wrapping up","FAQ"]},"relativePagePath":"/developing/react-tutorial/step-3.mdx","titleType":"prepend","MdxNode":{"id":"eda9fc2a-eade-572d-98dd-8ef839e770bd","children":[],"parent":"e313048c-3ecc-5af7-bc7f-a9bc46f9924c","internal":{"content":"---\ntitle: 3. Using APIs\ndescription:\n  Welcome to Carbon! This tutorial will guide you in creating a React app using\n  Next.js with the Carbon Design System.\ntabs:\n  [\n    'Overview',\n    'Step 1',\n    'Step 2',\n    'Step 3',\n    'Step 4',\n    'Step 5',\n    'Wrapping up',\n    'FAQ',\n  ]\n---\n\nimport Preview from 'components/Preview';\n\n<PageDescription>\n\nThis step takes our static components and populates them with data from the\nGitHub GraphQL API – loading states and all. We'll be displaying Carbon\nrepository information in a data table.\n\n</PageDescription>\n\n<AnchorLinks>\n\n<AnchorLink>Fork, clone and branch</AnchorLink>\n<AnchorLink>Install dependencies</AnchorLink>\n<AnchorLink>Fetch data</AnchorLink>\n<AnchorLink>Populate data table</AnchorLink>\n<AnchorLink>Add loading</AnchorLink>\n<AnchorLink>Add pagination</AnchorLink>\n<AnchorLink>Submit pull request</AnchorLink>\n\n</AnchorLinks>\n\n### Preview\n\nThe [Github REST API](https://docs.github.com/en/rest?apiVersion=2022-11-28) is\nvery well documented, we'll use it to fetch Carbon-related data for this Carbon\ntutorial.\n\nTo do so, we'll be using\n[Octokit Core](https://github.com/octokit/core.js/#readme), a client that makes\nit easy to interact with Github's APIs.\n\nA\n[preview](https://carbon-tutorial-nextjs-8xoxdcixk-carbon-design-system.vercel.app/)\nof what you will build (see repositories page):\n\n<Preview\n  height=\"400\"\n  title=\"Carbon Tutorial Step 3\"\n  src=\"https://carbon-tutorial-nextjs-8xoxdcixk-carbon-design-system.vercel.app/\"\n  frameborder=\"no\"\n  allowtransparency=\"true\"\n  allowfullscreen=\"true\"\n/>\n\n## Fork, clone and branch\n\nThis tutorial has an accompanying GitHub repository called\n[carbon-tutorial-nextjs](https://github.com/carbon-design-system/carbon-tutorial-nextjs)\nthat we'll use as a starting point for each step. If you haven't forked and\ncloned that repository yet, and haven't added the upstream remote, go ahead and\ndo so by following the\n[step 1 instructions](/developing/react-tutorial/step-1#fork-clone-and-branch).\n\n### Branch\n\nWith your repository all set up, let's check out the branch for this tutorial\nstep's starting point.\n\n```bash\ngit fetch upstream\ngit checkout -b v11-next-step-3 upstream/v11-next-step-3\n```\n\n### Build and start app\n\nInstall the app's dependencies and build the app:\n\n```bash\nyarn && yarn build\n```\n\nThen, start the app:\n\n```bash\nyarn start\n```\n\nYou should see something similar to where the\n[previous step](/developing/react-tutorial/step-2) left off. Stop your app with\n`CTRL-C` and let's get everything installed.\n\n## Install dependencies\n\nWe'll need to install `@octokit/core`, a package that allows us to query Github\nAPIs easily. Stop your development server with `CTRL-C` and install the octokit\ndependency with:\n\n```bash\nyarn add @octokit/core@4.2.0\n```\n\nThen, start the app again. If your app's currently running, you'll need to\nrestart it.\n\n```bash\nyarn dev\n```\n\n## Fetch data\n\n### Imports\n\nWe'll be using [React Hooks](https://reactjs.org/docs/hooks-intro.html) to call\na function to fetch our data when the component renders.\n\nImport React's [useEffect](https://reactjs.org/docs/hooks-effect.html) by\nmodifying the `React` import in `src/app/repos/page.js`.\n\n```javascript path=src/app/repos/page.js\nimport React, { useEffect } from 'react';\n```\n\nAdd the following import below the react import in `RepoPage`:\n\n```javascript path=src/app/repos/page.js\nimport { Octokit } from '@octokit/core';\n```\n\n### Initializing Octokit client\n\nDirectly below all your imports, initialize an octokit client which we'll use to\nquery our `RepoTable` data:\n\n```javascript path=src/app/repos/page.js\nconst octokitClient = new Octokit({});\n```\n\n### API Request\n\nNext, we'll assemble our Github API request to fetch a list of repositories that\nbelong to the `carbon-design-system` Github organization. We'll do this by using\na `useEffect` hook that will use octokit to query Github's API\n[repositories endpoint](https://docs.github.com/en/rest/repos/repos?apiVersion=2022-11-28#list-organization-repositories).\n\nLet's declare a `useEffect` hook immediately below the component definition and\nabove the return. We'll use this to query Github's API when the component first\nrenders:\n\n```javascript path=src/app/repos/page.js\nfunction RepoPage() {\n  useEffect(() => {\n    async function getCarbonRepos() {\n      const res = await octokitClient.request('GET /orgs/{org}/repos', {\n        org: 'carbon-design-system',\n        per_page: 75,\n        sort: 'updated',\n        direction: 'desc',\n      });\n\n      if (res.status === 200) {\n        console.log(res.data);\n      } else {\n        console.log('Error obtaining repository data');\n      }\n    }\n\n    getCarbonRepos();\n  }, []);\n```\n\nAt this point, if you navigate to the Repositories page `/repos` in your running\napp and view your browser's console (e.g.\n[Chrome DevTools](https://developer.chrome.com/docs/devtools/)), you should see\nthe response from GitHub!\n\n### Helpers\n\nOur last column in the data table will be a comma-separated list of repository\nand home page links, so let's create a component called `LinkList`.\n\nImport `Link` at the top of `/app/repos/page.js`. The imports should look like\nthis.\n\n```javascript path=src/app/repos/page.js\nimport { Link, Grid, Column } from '@carbon/react';\n```\n\nThen use `Link` in this component. It has two props (`url` and `homepageUrl`)\nand returns an unordered list. If the repository does not have a home page URL,\nonly render the repository link.\n\n```javascript path=src/app/repos/page.js\nconst LinkList = ({ url, homepageUrl }) => (\n  <ul style={{ display: 'flex' }}>\n    <li>\n      <Link href={url}>GitHub</Link>\n    </li>\n    {homepageUrl && (\n      <li>\n        <span>&nbsp;|&nbsp;</span>\n        <Link href={homepageUrl}>Homepage</Link>\n      </li>\n    )}\n  </ul>\n);\n```\n\nAs a final helper, let's create a function that transforms row data to our\nexpected header keys. Notice how we're using our new `LinkList` component to\ngenerate the value of the `links` key in each row.\n\n```javascript path=src/app/repos/page.js\nconst getRowItems = (rows) =>\n  rows.map((row) => ({\n    ...row,\n    key: row.id,\n    stars: row.stargazers_count,\n    issueCount: row.open_issues_count,\n    createdAt: new Date(row.created_at).toLocaleDateString(),\n    updatedAt: new Date(row.updated_at).toLocaleDateString(),\n    links: <LinkList url={row.html_url} homepageUrl={row.homepage} />,\n  }));\n```\n\n### Populate data table\n\nNow that we have our data, let's dispose of our dummy `rows` and populate the\ndata table with real data.\n\nFirst, towards the top of `RepoPage` delete the `rows` array because we no\nlonger need the example rows.\n\nNext, let's add a couple variables that will help us store useful information\nwhen fetching the data and keep track of the loading state.\n\nWe'll be using [React Hooks](https://reactjs.org/docs/hooks-intro.html) again to\nmanage our state.\n\nImport React's [useState](https://reactjs.org/docs/hooks-state.html) by\nmodifying the `React` import.\n\n```javascript path=src/app/repos/page.js\nimport React, { useEffect, useState } from 'react';\n```\n\nThen, inside the `RepoPage` component:\n\n```javascript path=src/app/repos/page.js\nfunction RepoPage() {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState();\n  const [rows, setRows] = useState([]);\n```\n\nNow, instead of using `console.log` to log the github data response, let's treat\nthe response data by passing it through our `getRowItems` helper and saving the\nresult in our new `rows` variable. Replace the `console.log(res.data);` line\ninside `if (res.status === 200)` with:\n\n```javascript path=src/app/repos/page.js\nsetRows(getRowItems(res.data));\n```\n\nLet's also replace our error log line inside the `else` statement with:\n\n```javascript path=src/app/repos/page.js\nsetError('Error obtaining repository data');\n```\n\nTo complete our `getCarbonRepos` function, let's set the loading state to false\nright after the `else` statement:\n\n```javascript path=src/app/repos/page.js\nif (res.status === 200) {\n  setRows(getRowItems(res.data));\n} else {\n  setError('Error obtaining repository data');\n}\nsetLoading(false);\n```\n\nFinally, let's modify our component's `return()` statement to display different\ninformation depending on the states of our request: loading, error or complete.\nReplace the current return statement with:\n\n```javascript path=src/app/repos/page.js\nif (loading) {\n  return 'Loading...';\n}\n\nif (error) {\n  return `Error! ${error}`;\n}\n\n// If we're here, we've got our data!\nreturn (\n  <Grid className=\"repo-page\">\n    <Column lg={16} md={8} sm={4} className=\"repo-page__r1\">\n      <RepoTable headers={headers} rows={rows} />\n    </Column>\n  </Grid>\n);\n```\n\n### Render repository descriptions\n\nThe data table component and its pieces use a common React pattern called\n[render props](https://reactjs.org/docs/render-props.html). This is a really\npowerful way for libraries to give developers control of rendering and\nmanipulating their data.\n\nRevisiting `RepoTable.js`, we are already passing in our row objects along with\nheaders for each column. The `render` prop is being used to tell the data table\nhow to render the headers and rows. That prop takes a function that receives the\nprocessed headers and rows as arguments as well as some helper functions for\nrendering the table.\n\nOne common hurdle with the data table is how to access data that might not\ncorrespond with a table column but is needed to compute the value of a cell that\ndoes. The data table component processes and controls only the row properties\nwhich corresponds to headers (columns). Because of this, the `rows` object you\nget access to in the render prop function is _different_ than the one you passed\nin to the `rows` prop.\n\nWe need to modify one aspect of the data table because if you expand a row, it\nsays `Row description`. We want to update that with the repository description\ncoming from the GitHub API. This is an example of where we need a simple look-up\nfunction to find the data we care about - data that does not directly correspond\nto a column.\n\nTo do so, in `RepoTable.js`, add this look-up function as the first lines inside\nthe `RepoTable`. This should go immediately before the component's `return()`.\n\n```javascript path=src/app/repos/RepoTable.js\nconst getRowDescription = (rowId) => {\n  const row = rows.find(({ id }) => id === rowId);\n  return row ? row.description : '';\n};\n```\n\nFinally, in `RepoTable.js`, replace `<p>Row description</p>` with:\n\n```html path=src/app/repos/RepoTable.js\n<p>{getRowDescription(row.id)}</p>\n```\n\n## Add loading\n\nAt this point, the first time that you visit the repositories page, we're\nquerying the GitHub API and rendering the response through the `DataTable`\ncomponent. We could stop here, but there's more to be done! Let's replace the\n`Loading...` string with the\n[DataTableSkeleton component](https://react.carbondesignsystem.com/?path=/story/components-datatable--skeleton).\n\nTo do so, back to `RepoPage`, add the `DataTableSkeleton` import by modifying\nthe existing `@carbon/react` import.\n\n```javascript path=src/app/repos/page.js\nimport { Link, DataTableSkeleton, Grid, Column } from '@carbon/react';\n```\n\nThen replace the `if (loading) return 'Loading...';` with:\n\n```javascript path=src/app/repos/page.js\nif (loading) {\n  return (\n    <Grid className=\"repo-page\">\n      <Column lg={16} md={8} sm={4} className=\"repo-page__r1\">\n        <DataTableSkeleton\n          columnCount={headers.length + 1}\n          rowCount={10}\n          headers={headers}\n        />\n      </Column>\n    </Grid>\n  );\n}\n```\n\nWe need to tell the loading skeleton how many rows to render, so let's use 10\nskeleton rows to prepare for the next enhancement...\n\n## Add pagination\n\nPagination! Instead of rendering every repository, let's add pagination to the\ndata table to only render 10 at a time. Depending on your specific requirements,\nyou may need to fetch new data each time that you interact with the pagination\ncomponent, but for simplicity, we're going to make one request to fetch all\ndata, and then paginate the in-memory row data.\n\nInitialize the new state variables that we'll use for pagination as the first\nlines inside the `RepoPage`.\n\n```javascript path=src/app/repos/page.js\nfunction RepoPage() {\n  const [firstRowIndex, setFirstRowIndex] = useState(0);\n  const [currentPageSize, setCurrentPageSize] = useState(10);\n...\n```\n\nThis initializes the total number of rows and the index of the first row to `0`,\nand the page size to `10` as we also specified in our loading skeleton.\n\nThen we need to update our `RepoTable` `rows` prop to only render the subset of\nrows for the current \"page\". Update\n`<RepoTable headers={headers} rows={rows} />` to:\n\n```javascript path=src/app/repos/page.js\n<RepoTable\n  headers={headers}\n  rows={rows.slice(firstRowIndex, firstRowIndex + currentPageSize)}\n/>\n```\n\n<InlineNotification>\n\n**Note:** We only pass the rows that we want our table to display. We can do\nthis by slicing the array of rows depending on the first item and the page size.\n\n</InlineNotification>\n\nFinally, let's add the `Pagination` to update our state variables and cause the\ndata table to render new rows.\n\nImport `Pagination` by updating the `@carbon/react` import.\n\n```javascript path=src/app/repos/page.js\nimport {\n  Link,\n  DataTableSkeleton,\n  Pagination,\n  Grid,\n  Column,\n} from '@carbon/react';\n```\n\nImmediately after the `RepoTable` closing tag (`/>`), add the `Pagination`\ncomponent using the state variables that we previously initialized.\n\n```javascript path=src/app/repos/page.js\n<Pagination\n  totalItems={rows.length}\n  backwardText=\"Previous page\"\n  forwardText=\"Next page\"\n  pageSize={currentPageSize}\n  pageSizes={[5, 10, 15, 25]}\n  itemsPerPageText=\"Items per page\"\n  onChange={({ page, pageSize }) => {\n    if (pageSize !== currentPageSize) {\n      setCurrentPageSize(pageSize);\n    }\n    setFirstRowIndex(pageSize * (page - 1));\n  }}\n/>\n```\n\n<InlineNotification>\n\n**Note:** The `Pagination` component isn't inherently connected in any way to\nthe `DataTable` - we need to tell it what to do when a change occurs using the\n`onChange` prop. This includes both page size changes and displaying different\nrows.\n\n</InlineNotification>\n\n<InlineNotification>\n\n**Note:** Like the other Carbon React components, `Pagination` component\nexamples can be found in\n[Storybook](https://react.carbondesignsystem.com/?path=/story/components-pagination--pagination)\nby browsing the story and knobs.\n\n</InlineNotification>\n\nThat does it! Your data table should fetch GitHub data on first render. You can\nexpand each row to see the repository's description. You can modify the\npagination items per page and cycle through pages or jump to a specific page of\nrepositories.\n\n## Submit pull request\n\nWe're going to submit a pull request to verify completion of this tutorial step.\n\n### Continuous integration (CI) check\n\nRun the CI check to make sure we're all set to submit a pull request.\n\n```bash\nyarn ci-check\n```\n\n<InlineNotification>\n\n**Note:** Having issues running the CI check?\n[Step 1](</developing/react-tutorial/step-1#continuous-integration-(ci)-check>)\nhas troubleshooting notes that may help.\n\n</InlineNotification>\n\n### Git commit and push\n\nBefore we can create a pull request, format your code, then stage and commit all\nof your changes:\n\n```bash\nyarn format\ngit add --all && git commit -m \"feat(tutorial): complete step 3\"\n```\n\nThen, push to your repository:\n\n```bash\ngit push origin v11-next-step-3\n```\n\n<InlineNotification>\n\n**Note:** Having issues pushing your changes?\n[Step 1](/developing/react-tutorial/step-1#git-commit-and-push) has\ntroubleshooting notes that may help.\n\n</InlineNotification>\n\n### Pull request (PR)\n\nFinally, visit\n[carbon-tutorial-nextjs](https://github.com/carbon-design-system/carbon-tutorial-nextjs)\nto \"Compare & pull request\". In doing so, make sure that you are comparing to\n`v11-next-step-3` into `base: v11-next-step-3`.\n\n<InlineNotification>\n\n**Note:** Expect your tutorial step PRs to be reviewed by the Carbon team but\nnot merged. We'll close your PR so we can keep the repository's remote branches\npristine and ready for the next person!\n\n</InlineNotification>\n\n<InlineNotification>\n\n**Note:** If your PR fails the CircleCI test with the error\n`Can't make a request in offline mode`, try running the following command:\n`rm -rf .yarn-offline-mirror node_modules && yarn cache clean && yarn install`.\nAdd and commit the changes once this completes, and try pushing again.\n\n</InlineNotification>\n","type":"Mdx","contentDigest":"78a5bbfc6d40a6ce5c0629de871cc523","owner":"gatsby-plugin-mdx","counter":5026},"frontmatter":{"title":"3. Using APIs","description":"Welcome to Carbon! This tutorial will guide you in creating a React app using Next.js with the Carbon Design System.","tabs":["Overview","Step 1","Step 2","Step 3","Step 4","Step 5","Wrapping up","FAQ"]},"exports":{},"rawBody":"---\ntitle: 3. Using APIs\ndescription:\n  Welcome to Carbon! This tutorial will guide you in creating a React app using\n  Next.js with the Carbon Design System.\ntabs:\n  [\n    'Overview',\n    'Step 1',\n    'Step 2',\n    'Step 3',\n    'Step 4',\n    'Step 5',\n    'Wrapping up',\n    'FAQ',\n  ]\n---\n\nimport Preview from 'components/Preview';\n\n<PageDescription>\n\nThis step takes our static components and populates them with data from the\nGitHub GraphQL API – loading states and all. We'll be displaying Carbon\nrepository information in a data table.\n\n</PageDescription>\n\n<AnchorLinks>\n\n<AnchorLink>Fork, clone and branch</AnchorLink>\n<AnchorLink>Install dependencies</AnchorLink>\n<AnchorLink>Fetch data</AnchorLink>\n<AnchorLink>Populate data table</AnchorLink>\n<AnchorLink>Add loading</AnchorLink>\n<AnchorLink>Add pagination</AnchorLink>\n<AnchorLink>Submit pull request</AnchorLink>\n\n</AnchorLinks>\n\n### Preview\n\nThe [Github REST API](https://docs.github.com/en/rest?apiVersion=2022-11-28) is\nvery well documented, we'll use it to fetch Carbon-related data for this Carbon\ntutorial.\n\nTo do so, we'll be using\n[Octokit Core](https://github.com/octokit/core.js/#readme), a client that makes\nit easy to interact with Github's APIs.\n\nA\n[preview](https://carbon-tutorial-nextjs-8xoxdcixk-carbon-design-system.vercel.app/)\nof what you will build (see repositories page):\n\n<Preview\n  height=\"400\"\n  title=\"Carbon Tutorial Step 3\"\n  src=\"https://carbon-tutorial-nextjs-8xoxdcixk-carbon-design-system.vercel.app/\"\n  frameborder=\"no\"\n  allowtransparency=\"true\"\n  allowfullscreen=\"true\"\n/>\n\n## Fork, clone and branch\n\nThis tutorial has an accompanying GitHub repository called\n[carbon-tutorial-nextjs](https://github.com/carbon-design-system/carbon-tutorial-nextjs)\nthat we'll use as a starting point for each step. If you haven't forked and\ncloned that repository yet, and haven't added the upstream remote, go ahead and\ndo so by following the\n[step 1 instructions](/developing/react-tutorial/step-1#fork-clone-and-branch).\n\n### Branch\n\nWith your repository all set up, let's check out the branch for this tutorial\nstep's starting point.\n\n```bash\ngit fetch upstream\ngit checkout -b v11-next-step-3 upstream/v11-next-step-3\n```\n\n### Build and start app\n\nInstall the app's dependencies and build the app:\n\n```bash\nyarn && yarn build\n```\n\nThen, start the app:\n\n```bash\nyarn start\n```\n\nYou should see something similar to where the\n[previous step](/developing/react-tutorial/step-2) left off. Stop your app with\n`CTRL-C` and let's get everything installed.\n\n## Install dependencies\n\nWe'll need to install `@octokit/core`, a package that allows us to query Github\nAPIs easily. Stop your development server with `CTRL-C` and install the octokit\ndependency with:\n\n```bash\nyarn add @octokit/core@4.2.0\n```\n\nThen, start the app again. If your app's currently running, you'll need to\nrestart it.\n\n```bash\nyarn dev\n```\n\n## Fetch data\n\n### Imports\n\nWe'll be using [React Hooks](https://reactjs.org/docs/hooks-intro.html) to call\na function to fetch our data when the component renders.\n\nImport React's [useEffect](https://reactjs.org/docs/hooks-effect.html) by\nmodifying the `React` import in `src/app/repos/page.js`.\n\n```javascript path=src/app/repos/page.js\nimport React, { useEffect } from 'react';\n```\n\nAdd the following import below the react import in `RepoPage`:\n\n```javascript path=src/app/repos/page.js\nimport { Octokit } from '@octokit/core';\n```\n\n### Initializing Octokit client\n\nDirectly below all your imports, initialize an octokit client which we'll use to\nquery our `RepoTable` data:\n\n```javascript path=src/app/repos/page.js\nconst octokitClient = new Octokit({});\n```\n\n### API Request\n\nNext, we'll assemble our Github API request to fetch a list of repositories that\nbelong to the `carbon-design-system` Github organization. We'll do this by using\na `useEffect` hook that will use octokit to query Github's API\n[repositories endpoint](https://docs.github.com/en/rest/repos/repos?apiVersion=2022-11-28#list-organization-repositories).\n\nLet's declare a `useEffect` hook immediately below the component definition and\nabove the return. We'll use this to query Github's API when the component first\nrenders:\n\n```javascript path=src/app/repos/page.js\nfunction RepoPage() {\n  useEffect(() => {\n    async function getCarbonRepos() {\n      const res = await octokitClient.request('GET /orgs/{org}/repos', {\n        org: 'carbon-design-system',\n        per_page: 75,\n        sort: 'updated',\n        direction: 'desc',\n      });\n\n      if (res.status === 200) {\n        console.log(res.data);\n      } else {\n        console.log('Error obtaining repository data');\n      }\n    }\n\n    getCarbonRepos();\n  }, []);\n```\n\nAt this point, if you navigate to the Repositories page `/repos` in your running\napp and view your browser's console (e.g.\n[Chrome DevTools](https://developer.chrome.com/docs/devtools/)), you should see\nthe response from GitHub!\n\n### Helpers\n\nOur last column in the data table will be a comma-separated list of repository\nand home page links, so let's create a component called `LinkList`.\n\nImport `Link` at the top of `/app/repos/page.js`. The imports should look like\nthis.\n\n```javascript path=src/app/repos/page.js\nimport { Link, Grid, Column } from '@carbon/react';\n```\n\nThen use `Link` in this component. It has two props (`url` and `homepageUrl`)\nand returns an unordered list. If the repository does not have a home page URL,\nonly render the repository link.\n\n```javascript path=src/app/repos/page.js\nconst LinkList = ({ url, homepageUrl }) => (\n  <ul style={{ display: 'flex' }}>\n    <li>\n      <Link href={url}>GitHub</Link>\n    </li>\n    {homepageUrl && (\n      <li>\n        <span>&nbsp;|&nbsp;</span>\n        <Link href={homepageUrl}>Homepage</Link>\n      </li>\n    )}\n  </ul>\n);\n```\n\nAs a final helper, let's create a function that transforms row data to our\nexpected header keys. Notice how we're using our new `LinkList` component to\ngenerate the value of the `links` key in each row.\n\n```javascript path=src/app/repos/page.js\nconst getRowItems = (rows) =>\n  rows.map((row) => ({\n    ...row,\n    key: row.id,\n    stars: row.stargazers_count,\n    issueCount: row.open_issues_count,\n    createdAt: new Date(row.created_at).toLocaleDateString(),\n    updatedAt: new Date(row.updated_at).toLocaleDateString(),\n    links: <LinkList url={row.html_url} homepageUrl={row.homepage} />,\n  }));\n```\n\n### Populate data table\n\nNow that we have our data, let's dispose of our dummy `rows` and populate the\ndata table with real data.\n\nFirst, towards the top of `RepoPage` delete the `rows` array because we no\nlonger need the example rows.\n\nNext, let's add a couple variables that will help us store useful information\nwhen fetching the data and keep track of the loading state.\n\nWe'll be using [React Hooks](https://reactjs.org/docs/hooks-intro.html) again to\nmanage our state.\n\nImport React's [useState](https://reactjs.org/docs/hooks-state.html) by\nmodifying the `React` import.\n\n```javascript path=src/app/repos/page.js\nimport React, { useEffect, useState } from 'react';\n```\n\nThen, inside the `RepoPage` component:\n\n```javascript path=src/app/repos/page.js\nfunction RepoPage() {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState();\n  const [rows, setRows] = useState([]);\n```\n\nNow, instead of using `console.log` to log the github data response, let's treat\nthe response data by passing it through our `getRowItems` helper and saving the\nresult in our new `rows` variable. Replace the `console.log(res.data);` line\ninside `if (res.status === 200)` with:\n\n```javascript path=src/app/repos/page.js\nsetRows(getRowItems(res.data));\n```\n\nLet's also replace our error log line inside the `else` statement with:\n\n```javascript path=src/app/repos/page.js\nsetError('Error obtaining repository data');\n```\n\nTo complete our `getCarbonRepos` function, let's set the loading state to false\nright after the `else` statement:\n\n```javascript path=src/app/repos/page.js\nif (res.status === 200) {\n  setRows(getRowItems(res.data));\n} else {\n  setError('Error obtaining repository data');\n}\nsetLoading(false);\n```\n\nFinally, let's modify our component's `return()` statement to display different\ninformation depending on the states of our request: loading, error or complete.\nReplace the current return statement with:\n\n```javascript path=src/app/repos/page.js\nif (loading) {\n  return 'Loading...';\n}\n\nif (error) {\n  return `Error! ${error}`;\n}\n\n// If we're here, we've got our data!\nreturn (\n  <Grid className=\"repo-page\">\n    <Column lg={16} md={8} sm={4} className=\"repo-page__r1\">\n      <RepoTable headers={headers} rows={rows} />\n    </Column>\n  </Grid>\n);\n```\n\n### Render repository descriptions\n\nThe data table component and its pieces use a common React pattern called\n[render props](https://reactjs.org/docs/render-props.html). This is a really\npowerful way for libraries to give developers control of rendering and\nmanipulating their data.\n\nRevisiting `RepoTable.js`, we are already passing in our row objects along with\nheaders for each column. The `render` prop is being used to tell the data table\nhow to render the headers and rows. That prop takes a function that receives the\nprocessed headers and rows as arguments as well as some helper functions for\nrendering the table.\n\nOne common hurdle with the data table is how to access data that might not\ncorrespond with a table column but is needed to compute the value of a cell that\ndoes. The data table component processes and controls only the row properties\nwhich corresponds to headers (columns). Because of this, the `rows` object you\nget access to in the render prop function is _different_ than the one you passed\nin to the `rows` prop.\n\nWe need to modify one aspect of the data table because if you expand a row, it\nsays `Row description`. We want to update that with the repository description\ncoming from the GitHub API. This is an example of where we need a simple look-up\nfunction to find the data we care about - data that does not directly correspond\nto a column.\n\nTo do so, in `RepoTable.js`, add this look-up function as the first lines inside\nthe `RepoTable`. This should go immediately before the component's `return()`.\n\n```javascript path=src/app/repos/RepoTable.js\nconst getRowDescription = (rowId) => {\n  const row = rows.find(({ id }) => id === rowId);\n  return row ? row.description : '';\n};\n```\n\nFinally, in `RepoTable.js`, replace `<p>Row description</p>` with:\n\n```html path=src/app/repos/RepoTable.js\n<p>{getRowDescription(row.id)}</p>\n```\n\n## Add loading\n\nAt this point, the first time that you visit the repositories page, we're\nquerying the GitHub API and rendering the response through the `DataTable`\ncomponent. We could stop here, but there's more to be done! Let's replace the\n`Loading...` string with the\n[DataTableSkeleton component](https://react.carbondesignsystem.com/?path=/story/components-datatable--skeleton).\n\nTo do so, back to `RepoPage`, add the `DataTableSkeleton` import by modifying\nthe existing `@carbon/react` import.\n\n```javascript path=src/app/repos/page.js\nimport { Link, DataTableSkeleton, Grid, Column } from '@carbon/react';\n```\n\nThen replace the `if (loading) return 'Loading...';` with:\n\n```javascript path=src/app/repos/page.js\nif (loading) {\n  return (\n    <Grid className=\"repo-page\">\n      <Column lg={16} md={8} sm={4} className=\"repo-page__r1\">\n        <DataTableSkeleton\n          columnCount={headers.length + 1}\n          rowCount={10}\n          headers={headers}\n        />\n      </Column>\n    </Grid>\n  );\n}\n```\n\nWe need to tell the loading skeleton how many rows to render, so let's use 10\nskeleton rows to prepare for the next enhancement...\n\n## Add pagination\n\nPagination! Instead of rendering every repository, let's add pagination to the\ndata table to only render 10 at a time. Depending on your specific requirements,\nyou may need to fetch new data each time that you interact with the pagination\ncomponent, but for simplicity, we're going to make one request to fetch all\ndata, and then paginate the in-memory row data.\n\nInitialize the new state variables that we'll use for pagination as the first\nlines inside the `RepoPage`.\n\n```javascript path=src/app/repos/page.js\nfunction RepoPage() {\n  const [firstRowIndex, setFirstRowIndex] = useState(0);\n  const [currentPageSize, setCurrentPageSize] = useState(10);\n...\n```\n\nThis initializes the total number of rows and the index of the first row to `0`,\nand the page size to `10` as we also specified in our loading skeleton.\n\nThen we need to update our `RepoTable` `rows` prop to only render the subset of\nrows for the current \"page\". Update\n`<RepoTable headers={headers} rows={rows} />` to:\n\n```javascript path=src/app/repos/page.js\n<RepoTable\n  headers={headers}\n  rows={rows.slice(firstRowIndex, firstRowIndex + currentPageSize)}\n/>\n```\n\n<InlineNotification>\n\n**Note:** We only pass the rows that we want our table to display. We can do\nthis by slicing the array of rows depending on the first item and the page size.\n\n</InlineNotification>\n\nFinally, let's add the `Pagination` to update our state variables and cause the\ndata table to render new rows.\n\nImport `Pagination` by updating the `@carbon/react` import.\n\n```javascript path=src/app/repos/page.js\nimport {\n  Link,\n  DataTableSkeleton,\n  Pagination,\n  Grid,\n  Column,\n} from '@carbon/react';\n```\n\nImmediately after the `RepoTable` closing tag (`/>`), add the `Pagination`\ncomponent using the state variables that we previously initialized.\n\n```javascript path=src/app/repos/page.js\n<Pagination\n  totalItems={rows.length}\n  backwardText=\"Previous page\"\n  forwardText=\"Next page\"\n  pageSize={currentPageSize}\n  pageSizes={[5, 10, 15, 25]}\n  itemsPerPageText=\"Items per page\"\n  onChange={({ page, pageSize }) => {\n    if (pageSize !== currentPageSize) {\n      setCurrentPageSize(pageSize);\n    }\n    setFirstRowIndex(pageSize * (page - 1));\n  }}\n/>\n```\n\n<InlineNotification>\n\n**Note:** The `Pagination` component isn't inherently connected in any way to\nthe `DataTable` - we need to tell it what to do when a change occurs using the\n`onChange` prop. This includes both page size changes and displaying different\nrows.\n\n</InlineNotification>\n\n<InlineNotification>\n\n**Note:** Like the other Carbon React components, `Pagination` component\nexamples can be found in\n[Storybook](https://react.carbondesignsystem.com/?path=/story/components-pagination--pagination)\nby browsing the story and knobs.\n\n</InlineNotification>\n\nThat does it! Your data table should fetch GitHub data on first render. You can\nexpand each row to see the repository's description. You can modify the\npagination items per page and cycle through pages or jump to a specific page of\nrepositories.\n\n## Submit pull request\n\nWe're going to submit a pull request to verify completion of this tutorial step.\n\n### Continuous integration (CI) check\n\nRun the CI check to make sure we're all set to submit a pull request.\n\n```bash\nyarn ci-check\n```\n\n<InlineNotification>\n\n**Note:** Having issues running the CI check?\n[Step 1](</developing/react-tutorial/step-1#continuous-integration-(ci)-check>)\nhas troubleshooting notes that may help.\n\n</InlineNotification>\n\n### Git commit and push\n\nBefore we can create a pull request, format your code, then stage and commit all\nof your changes:\n\n```bash\nyarn format\ngit add --all && git commit -m \"feat(tutorial): complete step 3\"\n```\n\nThen, push to your repository:\n\n```bash\ngit push origin v11-next-step-3\n```\n\n<InlineNotification>\n\n**Note:** Having issues pushing your changes?\n[Step 1](/developing/react-tutorial/step-1#git-commit-and-push) has\ntroubleshooting notes that may help.\n\n</InlineNotification>\n\n### Pull request (PR)\n\nFinally, visit\n[carbon-tutorial-nextjs](https://github.com/carbon-design-system/carbon-tutorial-nextjs)\nto \"Compare & pull request\". In doing so, make sure that you are comparing to\n`v11-next-step-3` into `base: v11-next-step-3`.\n\n<InlineNotification>\n\n**Note:** Expect your tutorial step PRs to be reviewed by the Carbon team but\nnot merged. We'll close your PR so we can keep the repository's remote branches\npristine and ready for the next person!\n\n</InlineNotification>\n\n<InlineNotification>\n\n**Note:** If your PR fails the CircleCI test with the error\n`Can't make a request in offline mode`, try running the following command:\n`rm -rf .yarn-offline-mirror node_modules && yarn cache clean && yarn install`.\nAdd and commit the changes once this completes, and try pushing again.\n\n</InlineNotification>\n","fileAbsolutePath":"/home/runner/work/carbon-website/carbon-website/src/pages/developing/react-tutorial/step-3.mdx"}}},"staticQueryHashes":["1364590287","137577622","2102389209","2456312558","2746626797","3018647132","3037994772","768070550"]}